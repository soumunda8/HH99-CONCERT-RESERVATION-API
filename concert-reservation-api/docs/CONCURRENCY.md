# 동시성 이슈 분석 및 제어 방식 비교

## 1. 동시성 이슈 발생 구간
- **좌석 선점(예약):** 여러 사용자가 동시에 같은 좌석을 예약하려고 할 때 충돌이 발생할 수 있습니다. 이를 방지하지 않으면 좌석이 여러 사용자에게 중복으로 할당되는 문제가 발생할 수 있습니다.
- **유저 포인트 잔액:** 포인트 사용이나 충전 시 다중 사용자가 동시에 포인트에 접근하면 잔액이 정확하게 반영되지 않는 문제가 발생할 수 있습니다.

## 2. 비관적 락과 낙관적 락 비교

| **특성**          | **비관적 락 (Pessimistic Lock)**                                                                                                                                     | **낙관적 락 (Optimistic Lock)**                                                                                                                                                   |
|-------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **구현의 복잡도** | **낮음.** 비관적 락은 자원을 사용할 때마다 락을 걸어 동시성 문제를 차단하기 때문에, 트랜잭션 시작 시점부터 잠금을 걸어 구현이 단순합니다. 트랜잭션이 끝날 때까지 잠금을 유지하여 다른 사용자의 접근을 차단합니다. | **높음.** 낙관적 락은 트랜잭션이 끝날 때 충돌 검사를 하여 충돌이 있으면 트랜잭션을 롤백하는 방식이므로 버전 관리나 타임스탬프 관리를 통해 충돌을 검출해야 합니다. 구현이 복잡하며, 충돌 발생 시 재시도가 필요할 수 있습니다. |
| **성능**          | **낮음.** 모든 데이터 접근마다 락을 거는 방식으로 높은 트래픽 환경에서는 동시성 처리량이 제한될 수 있습니다. 여러 사용자가 동시에 접근하려고 할 때, 대기 시간 증가와 트랜잭션 지연으로 인해 성능이 저하됩니다.                | **높음.** 충돌이 발생하지 않는 한 동시 접근이 가능하여 성능에 영향을 덜 미칩니다. 다만, 충돌이 발생하면 롤백 및 재시도가 필요할 수 있어 이 경우 성능이 저하될 수 있습니다.              |
| **효율성**        | **높음** 경쟁이 심한 자원에 적합합니다. 충돌 가능성이 높을 때는 비관적 락을 통해 충돌을 미리 차단할 수 있어 관리가 용이합니다. 비관적 락은 데이터 무결성을 보장하는 데 효과적입니다.   | **높음** 충돌 가능성이 낮은 경우에는 낙관적 락이 적합합니다. 데이터 접근에 제한이 없기 때문에 처리 속도가 빠르며, 다수의 트랜잭션을 병렬로 처리할 수 있습니다. |

## 3. 평가 및 결론

### 좌석 선점(예약): 비관적 락
좌석 예약과 같은 자원 선점 문제는 동시 접근으로 인한 충돌 가능성이 높습니다. 비관적 락을 사용하여 좌석에 접근할 때마다 잠금을 걸어 다른 사용자가 동일 자원에 접근하지 못하도록 하면 이중 예약과 같은 동시성 문제를 방지할 수 있습니다. **비관적 락은 자원 선점 시 충돌 가능성이 클 때 적합**하며, 무결성을 보장하기에 유리합니다.

### 유저 포인트 잔액: 낙관적 락
포인트 잔액 관리에서 충돌 가능성은 상대적으로 낮습니다. 다만, 여러 사용자가 잔액을 동시에 조회하거나 수정할 수 있기 때문에 충돌 발생 시 롤백을 통한 재시도를 허용하는 낙관적 락이 효율적입니다. **낙관적 락은 충돌 가능성이 적고, 데이터 접근이 빈번한 경우 성능을 유지하기에 유리**합니다.

### 결론
위의 평가 결과를 기반으로 **좌석 선점에는 비관적 락을, 포인트 잔액 관리에는 낙관적 락을 도입**하여 동시성 문제를 관리해 보겠습니다.

### 참고 자료
- [낙관적 락과 비관적 락: 데이터베이스 동시성 제어 전략 - F-Lab](https://f-lab.kr/insight/understanding-optimistic-and-pessimistic-locking)
